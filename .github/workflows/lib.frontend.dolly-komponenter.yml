name: Frontend lib dolly-komponenter

on:
  push:
    paths:
      - navikt/dolly-komponenter/**
      - .github/workflows/lib.frontend.dolly-komponenter.yml

jobs:
  build:
    name: 'Build'
    runs-on: ubuntu-latest
    steps:
      - name: 'Setup Node'
        uses: actions/setup-node@v3
        with:
          node-version: 16.x
          registry-url: https://npm.pkg.github.com/
          scope: "@navikt"

      - name: 'Install'
        run: npm install --force
        env:
          NODE_AUTH_TOKEN: ${{ secrets.READER_TOKEN }}

      - name: 'Bygg'
        run: npm run build
  publish:
    name: Publish
    uses: navikt/testnorge/.github/workflows/common.js.publish.yml@bugfix/js-libs-build-error
    #TODO: Endre tilbake til @master
    if: ${{ github.ref == 'refs/heads/master' || contains(github.event.head_commit.message, '#publish-libs') }}
    with:
      working-directory: 'navikt/dolly-komponenter/'
      